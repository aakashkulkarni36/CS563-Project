Issue #224: Version bumps and Java 8 compatibility
URL: https://github.com/enviroCar/enviroCar-server/pull/224

Commit ID: 90b2cc6736994aae643e0cd960aca4bfdac0de79

Commit Message: version bumps and Java 8 compatibility

Files Changed (18):
File: core/src/main/java/org/envirocar/server/core/TemporalFilter.java ======================
    - Additions: 2
    - Deletions: 1
=======================================================

    +++Added (new line 21): import com.google.common.base.MoreObjects;
    ---Removed (old line 72):         return Objects.toStringHelper(TemporalFilter.class)
    +++Added (new line 73):         return MoreObjects.toStringHelper(TemporalFilter.class)

File: core/src/main/java/org/envirocar/server/core/entities/DimensionedNumber.java ======================
    - Additions: 2
    - Deletions: 1
=======================================================

    +++Added (new line 21): import com.google.common.base.MoreObjects;
    ---Removed (old line 86):         return Objects.toStringHelper(this)
    +++Added (new line 87):         return MoreObjects.toStringHelper(this)

File: core/src/main/java/org/envirocar/server/core/util/pagination/PageBasedPagination.java ======================
    - Additions: 2
    - Deletions: 1
=======================================================

    +++Added (new line 19): import com.google.common.base.MoreObjects;
    ---Removed (old line 122):         return Objects.toStringHelper(this)
    +++Added (new line 123):         return MoreObjects.toStringHelper(this)

File: core/src/main/java/org/envirocar/server/core/util/pagination/Paginated.java ======================
    - Additions: 2
    - Deletions: 2
=======================================================

    ---Removed (old line 19): import com.google.common.base.Objects;
    +++Added (new line 19): import com.google.common.base.MoreObjects;
    ---Removed (old line 100):         return Objects.toStringHelper(this)
    +++Added (new line 100):         return MoreObjects.toStringHelper(this)

File: mongo/pom.xml ======================
    - Additions: 5
    - Deletions: 1
=======================================================

    ---Removed (old line 2): <project xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd" 
    +++Added (new line 2): <project xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"
    +++Added (new line 61):         <dependency>
    +++Added (new line 62):             <groupId>com.google.code.findbugs</groupId>
    +++Added (new line 63):             <artifactId>jsr305</artifactId>
    +++Added (new line 64):         </dependency>

File: mongo/src/main/java/org/envirocar/server/mongo/MongoDB.java ======================
    - Additions: 9
    - Deletions: 18
=======================================================

    +++Added (new line 26): import org.envirocar.server.mongo.entity.MongoMeasurement;
    +++Added (new line 27): 
    ---Removed (old line 29): import com.github.jmkgreen.morphia.converters.DefaultConverters;
    +++Added (new line 45): import com.mongodb.BasicDBObjectBuilder;
    ---Removed (old line 49): import org.envirocar.server.mongo.entity.MongoMeasurement;
    ---Removed (old line 50): 
    ---Removed (old line 51): import com.mongodb.BasicDBObjectBuilder;
    ---Removed (old line 52): 
    ---Removed (old line 114):         DefaultConverters dc = getMapper().getConverters();
    ---Removed (old line 115):         for (TypeConverter tc : converters) {
    ---Removed (old line 116):             dc.addConverter(tc);
    ---Removed (old line 117):         }
    +++Added (new line 112):         converters.forEach(getMapper().getConverters()::addConverter);
    ---Removed (old line 121):         for (Class<?> c : mappedClasses) {
    ---Removed (old line 122):             getMapper().addMappedClass(c);
    ---Removed (old line 123):         }
    +++Added (new line 116):         mappedClasses.forEach(getMapper()::addMappedClass);
    ---Removed (old line 131):         collection.ensureIndex(new BasicDBObject(MongoMeasurement.GEOMETRY, "2dsphere"));
    ---Removed (old line 132):         collection.ensureIndex(new BasicDBObjectBuilder()
    +++Added (new line 124):         collection.createIndex(new BasicDBObject(MongoMeasurement.GEOMETRY, "2dsphere"));
    +++Added (new line 125):         collection.createIndex(new BasicDBObjectBuilder()
    ---Removed (old line 155):             List<Object> objIds = new ArrayList<Object>(kindKeys.size());
    +++Added (new line 148):             List<Object> objIds = new ArrayList<>(kindKeys.size());
    ---Removed (old line 159):             for (Key<T> key : kindKeys) {
    ---Removed (old line 160):                 objIds.add(key.getId());
    ---Removed (old line 161):             }
    +++Added (new line 152):             kindKeys.stream().map(Key::getId).forEach(objIds::add);

File: mongo/src/main/java/org/envirocar/server/mongo/activities/MongoActivity.java ======================
    - Additions: 6
    - Deletions: 4
=======================================================

    +++Added (new line 19): import java.util.Objects;
    +++Added (new line 20): 
    ---Removed (old line 36): import com.google.common.base.Objects;
    ---Removed (old line 37): import com.google.common.base.Objects.ToStringHelper;
    +++Added (new line 38): import com.google.common.base.MoreObjects;
    +++Added (new line 39): import com.google.common.base.MoreObjects.ToStringHelper;
    ---Removed (old line 154):         return Objects.equal(this.id, other.getId());
    +++Added (new line 156):         return Objects.equals(this.id, other.getId());
    ---Removed (old line 163):         return Objects.toStringHelper(this)
    +++Added (new line 165):         return MoreObjects.toStringHelper(this)

File: mongo/src/main/java/org/envirocar/server/mongo/dao/MongoMeasurementDao.java ======================
    - Additions: 13
    - Deletions: 29
=======================================================

    +++Added (new line 21): import java.util.Arrays;
    ---Removed (old line 228):         ArrayList<DBObject> filters = new ArrayList<DBObject>(4);
    +++Added (new line 229):         ArrayList<DBObject> ops = new ArrayList<>(6);
    ---Removed (old line 230):             filters.add(matchGeometry(filter.getGeometry()));
    +++Added (new line 231):             ops.add(matchGeometry(filter.getGeometry()));
    ---Removed (old line 233):             filters.add(matchUser(filter.getUser()));
    +++Added (new line 234):             ops.add(matchUser(filter.getUser()));
    ---Removed (old line 236):             filters.add(matchTrack(filter.getTrack()));
    +++Added (new line 237):             ops.add(matchTrack(filter.getTrack()));
    ---Removed (old line 239):             filters.add(matchTime(filter.getTemporalFilter()));
    +++Added (new line 240):             ops.add(matchTime(filter.getTemporalFilter()));
    ---Removed (old line 242):         final AggregationOutput out;
    ---Removed (old line 243):         if (filters.isEmpty()) {
    ---Removed (old line 244):             out = aggregate(project(), group());
    ---Removed (old line 245):         } else {
    ---Removed (old line 246):             int size = filters.size();
    ---Removed (old line 247):             if (size == 1) {
    ---Removed (old line 248):                 out = aggregate(filters.get(0), project(), group());
    ---Removed (old line 249):             } else {
    ---Removed (old line 250):                 DBObject first = filters.get(0);
    ---Removed (old line 251):                 DBObject[] other = new DBObject[size + 1];
    ---Removed (old line 252):                 for (int i = 1; i < size; ++i) {
    ---Removed (old line 253):                     other[i - 1] = filters.get(i);
    ---Removed (old line 254):                 }
    ---Removed (old line 255):                 other[other.length - 2] = project();
    ---Removed (old line 256):                 other[other.length - 1] = group();
    ---Removed (old line 257):                 out = aggregate(first, other);
    ---Removed (old line 258):             }
    ---Removed (old line 259):         }
    +++Added (new line 243):         ops.add(project());
    +++Added (new line 244):         ops.add(group());
    +++Added (new line 245): 
    +++Added (new line 246):         AggregationOutput out = aggregate(ops);
    ---Removed (old line 263):     private AggregationOutput aggregate(DBObject firstOp,
    ---Removed (old line 264):                                         DBObject... additionalOps) {
    ---Removed (old line 265):         AggregationOutput result = mongoDB.getDatastore()
    +++Added (new line 250):     private AggregationOutput aggregate(List<DBObject> ops) {
    +++Added (new line 251):         return mongoDB.getDatastore()
    ---Removed (old line 267):                 .aggregate(firstOp, additionalOps);
    ---Removed (old line 268):         result.getCommandResult().throwOnError();
    ---Removed (old line 269):         return result;
    +++Added (new line 253):                 .aggregate(ops);

File: mongo/src/main/java/org/envirocar/server/mongo/dao/MongoStatisticsDao.java ======================
    - Additions: 19
    - Deletions: 28
=======================================================

    +++Added (new line 19): import java.util.Arrays;
    ---Removed (old line 21): import com.github.jmkgreen.morphia.dao.BasicDAO;
    ---Removed (old line 22): import com.github.jmkgreen.morphia.mapping.Mapper;
    ---Removed (old line 23): import com.google.common.collect.Lists;
    ---Removed (old line 24): import com.google.inject.Inject;
    ---Removed (old line 25): import com.mongodb.AggregationOutput;
    ---Removed (old line 26): import com.mongodb.BasicDBObject;
    ---Removed (old line 27): import com.mongodb.BasicDBObjectBuilder;
    ---Removed (old line 28): import com.mongodb.DBObject;
    ---Removed (old line 29): import com.mongodb.DBRef;
    ---Removed (old line 30): 
    ---Removed (old line 32): 
    ---Removed (old line 47): 
    +++Added (new line 40): import com.github.jmkgreen.morphia.dao.BasicDAO;
    +++Added (new line 41): import com.github.jmkgreen.morphia.mapping.Mapper;
    +++Added (new line 42): import com.google.common.collect.Lists;
    +++Added (new line 43): import com.google.inject.Inject;
    +++Added (new line 44): import com.mongodb.AggregationOutput;
    +++Added (new line 45): import com.mongodb.BasicDBObject;
    +++Added (new line 46): import com.mongodb.BasicDBObjectBuilder;
    +++Added (new line 47): import com.mongodb.DBObject;
    +++Added (new line 48): import com.mongodb.DBRef;
    +++Added (new line 49): 
    ---Removed (old line 107):             AggregationOutput aggregate = aggregate(matches(request),
    ---Removed (old line 108):                                                     project(),
    ---Removed (old line 109):                                                     unwind(),
    ---Removed (old line 110):                                                     group());
    ---Removed (old line 111):             List<MongoStatistic> statistics =
    ---Removed (old line 112):                     parseStatistics(aggregate.results());
    ---Removed (old line 113): 
    +++Added (new line 106):             AggregationOutput aggregate = mongoDB.getDatastore()
    +++Added (new line 107):                     .getCollection(MongoMeasurement.class)
    +++Added (new line 108):                     .aggregate(Arrays.asList(
    +++Added (new line 109):                                     matches(request),
    +++Added (new line 110):                                     project(),
    +++Added (new line 111):                                     unwind(),
    +++Added (new line 112):                                     group()));
    +++Added (new line 113):             List<MongoStatistic> statistics = parseStatistics(aggregate.results());
    ---Removed (old line 129):     private AggregationOutput aggregate(DBObject firstOp,
    ---Removed (old line 130):                                         DBObject... additionalOps) {
    ---Removed (old line 131):         AggregationOutput result = mongoDB.getDatastore()
    ---Removed (old line 132):                 .getCollection(MongoMeasurement.class)
    ---Removed (old line 133):                 .aggregate(firstOp, additionalOps);
    ---Removed (old line 134):         result.getCommandResult().throwOnError();
    ---Removed (old line 135):         return result;
    ---Removed (old line 136):     }
    ---Removed (old line 137): 

File: mongo/src/main/java/org/envirocar/server/mongo/dao/privates/MongoPasswordResetDAO.java ======================
    - Additions: 8
    - Deletions: 8
=======================================================

    ---Removed (old line 38): public class MongoPasswordResetDAO extends AbstractMongoDao<ObjectId, MongoPasswordReset, MongoPasswordResetDAO.MongoPasswordResetStatusCollection> 
    +++Added (new line 38): public class MongoPasswordResetDAO extends AbstractMongoDao<ObjectId, MongoPasswordReset, MongoPasswordResetDAO.MongoPasswordResetStatusCollection>
    ---Removed (old line 59): 	
    +++Added (new line 59): 
    ---Removed (old line 63): 		
    +++Added (new line 63): 
    ---Removed (old line 77): 		
    +++Added (new line 77): 
    ---Removed (old line 82): 		save((MongoPasswordReset) entity);
    ---Removed (old line 83): 		
    +++Added (new line 82): 		save(entity);
    +++Added (new line 83): 
    ---Removed (old line 97): 		
    +++Added (new line 97): 
    ---Removed (old line 101): 		
    +++Added (new line 101): 

File: mongo/src/main/java/org/envirocar/server/mongo/entity/MongoEntityBase.java ======================
    - Additions: 3
    - Deletions: 3
=======================================================

    ---Removed (old line 31): import com.google.common.base.Objects;
    ---Removed (old line 32): import com.google.common.base.Objects.ToStringHelper;
    +++Added (new line 31): import com.google.common.base.MoreObjects;
    +++Added (new line 32): import com.google.common.base.MoreObjects.ToStringHelper;
    ---Removed (old line 101):         return Objects.toStringHelper(this)
    +++Added (new line 101):         return MoreObjects.toStringHelper(this)

File: mongo/src/main/java/org/envirocar/server/mongo/entity/MongoMeasurementValue.java ======================
    - Additions: 7
    - Deletions: 5
=======================================================

    +++Added (new line 19): import java.util.Objects;
    +++Added (new line 20): 
    ---Removed (old line 24): import com.google.common.base.Objects;
    +++Added (new line 26): import com.google.common.base.MoreObjects;
    ---Removed (old line 72):         return Objects.toStringHelper(this)
    +++Added (new line 74):         return MoreObjects.toStringHelper(this)
    ---Removed (old line 80):         return Objects.hashCode(this.value, this.phenomenon);
    +++Added (new line 82):         return Objects.hash(this.value, this.phenomenon);
    ---Removed (old line 92):         return Objects.equal(this.value, other.value) &&
    ---Removed (old line 93):                Objects.equal(this.phenomenon, other.phenomenon);
    +++Added (new line 94):         return Objects.equals(this.value, other.value) &&
    +++Added (new line 95):                Objects.equals(this.phenomenon, other.phenomenon);

File: pom.xml ======================
    - Additions: 17
    - Deletions: 12
=======================================================

    ---Removed (old line 45):         <logback-version>1.0.11</logback-version>
    +++Added (new line 45):         <logback-version>1.1.3</logback-version>
    ---Removed (old line 47):         <jersey-version>1.17.1</jersey-version>
    ---Removed (old line 48):         <guice-version>3.0</guice-version>
    ---Removed (old line 49):         <slf4j-version>1.7.5</slf4j-version>
    +++Added (new line 47):         <jersey-version>1.19</jersey-version>
    +++Added (new line 48):         <guice-version>4.0</guice-version>
    +++Added (new line 49):         <slf4j-version>1.7.12</slf4j-version>
    ---Removed (old line 156):                 <version>4.11</version>
    +++Added (new line 156):                 <version>4.12</version>
    ---Removed (old line 168): 				<version>1.9.5</version>
    +++Added (new line 168): 				<version>1.10.19</version>
    ---Removed (old line 184):                 <version>12.0</version>
    +++Added (new line 184):                 <version>18.0</version>
    +++Added (new line 211):             <dependency>
    +++Added (new line 212):                 <groupId>com.google.code.findbugs</groupId>
    +++Added (new line 213):                 <artifactId>jsr305</artifactId>
    +++Added (new line 214):                 <version>3.0.0</version>
    +++Added (new line 215):             </dependency>
    ---Removed (old line 246):                 <version>2.11.1</version>
    +++Added (new line 251):                 <version>2.13.2</version>
    ---Removed (old line 263):                 <version>2.2</version>
    +++Added (new line 268):                 <version>2.8.1</version>
    ---Removed (old line 327):                 <version>2.10.1</version>
    +++Added (new line 332):                 <version>2.13.0</version>
    ---Removed (old line 333):                 <version>1.8</version>
    +++Added (new line 338):                 <version>1.10</version>
    ---Removed (old line 338):                 <version>2.0.0-alpha.3-SNAPSHOT</version>
    +++Added (new line 343):                 <version>2.0.0-alpha.4-SNAPSHOT</version>

File: rest/pom.xml ======================
    - Additions: 4
    - Deletions: 0
=======================================================

    +++Added (new line 41):         <dependency>
    +++Added (new line 42):             <groupId>com.google.code.findbugs</groupId>
    +++Added (new line 43):             <artifactId>jsr305</artifactId>
    +++Added (new line 44):         </dependency>

File: rest/src/main/java/org/envirocar/server/rest/encoding/shapefile/TrackShapefileEncoder.java ======================
    - Additions: 43
    - Deletions: 45
=======================================================

    ---Removed (old line 74):  * 
    +++Added (new line 74):  *
    ---Removed (old line 82): 	
    +++Added (new line 82): 
    ---Removed (old line 92):     
    +++Added (new line 92): 
    ---Removed (old line 118):         
    +++Added (new line 118): 
    ---Removed (old line 127): 	
    +++Added (new line 127): 
    ---Removed (old line 138): 			}			
    +++Added (new line 138): 			}
    ---Removed (old line 141): 		} 
    ---Removed (old line 142): 		
    +++Added (new line 141): 		}
    +++Added (new line 142): 
    ---Removed (old line 157): 		
    +++Added (new line 157): 
    ---Removed (old line 163): 		
    +++Added (new line 163): 
    ---Removed (old line 172): 		typeBuilder.add(timeAttributeName, String.class);		
    ---Removed (old line 173): 		
    +++Added (new line 172): 		typeBuilder.add(timeAttributeName, String.class);
    +++Added (new line 173): 
    ---Removed (old line 177): 		}	
    ---Removed (old line 178): 		
    +++Added (new line 177): 		}
    +++Added (new line 178): 
    ---Removed (old line 180):         	
    +++Added (new line 180): 
    ---Removed (old line 184): 			
    +++Added (new line 184): 
    ---Removed (old line 188): 			
    +++Added (new line 188): 
    ---Removed (old line 190): 				
    +++Added (new line 190): 
    ---Removed (old line 192):         		
    +++Added (new line 192): 
    ---Removed (old line 200): 				
    +++Added (new line 200): 
    ---Removed (old line 209):         return  new ListFeatureCollection(sft, simpleFeatureList);		
    +++Added (new line 209):         return  new ListFeatureCollection(sft, simpleFeatureList);
    ---Removed (old line 211): 	
    +++Added (new line 211): 
    ---Removed (old line 215): 		
    +++Added (new line 215): 
    ---Removed (old line 217): 		
    +++Added (new line 217): 
    ---Removed (old line 221): 			
    +++Added (new line 221): 
    ---Removed (old line 234): 				
    +++Added (new line 234): 
    ---Removed (old line 239): 		
    +++Added (new line 239): 
    ---Removed (old line 248): 			String phenomenonNameAndUnit = (String) distinctPhenomenonNamesIterator
    ---Removed (old line 249): 					.next();
    ---Removed (old line 250): 			typeBuilder.add(phenomenonNameAndUnit,
    ---Removed (old line 251): 					String.class);
    +++Added (new line 248): 			String phenomenonNameAndUnit = distinctPhenomenonNamesIterator.next();
    +++Added (new line 249): 			typeBuilder.add(phenomenonNameAndUnit, String.class);
    ---Removed (old line 258): 		
    +++Added (new line 256): 
    ---Removed (old line 260): 		
    +++Added (new line 258): 
    ---Removed (old line 264): 		
    +++Added (new line 262): 
    ---Removed (old line 266): 		
    +++Added (new line 264): 
    ---Removed (old line 270): 		
    +++Added (new line 268): 
    ---Removed (old line 281): 		newDataStore.createSchema((SimpleFeatureType) collection.getSchema());
    +++Added (new line 279): 		newDataStore.createSchema(collection.getSchema());
    ---Removed (old line 311): 		
    +++Added (new line 309): 
    ---Removed (old line 318): 		
    +++Added (new line 316): 
    ---Removed (old line 321): 	
    +++Added (new line 319): 
    ---Removed (old line 330): 	
    +++Added (new line 328): 
    ---Removed (old line 332): 		
    ---Removed (old line 333): 		return propertyName + "(" + unit + ")";		
    +++Added (new line 330): 
    +++Added (new line 331): 		return propertyName + "(" + unit + ")";
    ---Removed (old line 335): 	
    +++Added (new line 333): 
    ---Removed (old line 350): 	
    +++Added (new line 348): 

File: rest/src/main/java/org/envirocar/server/rest/pagination/PaginationProvider.java ======================
    - Additions: 1
    - Deletions: 2
=======================================================

    ---Removed (old line 32):     public Pagination get()
    ---Removed (old line 33):             throws BadRequestException;
    +++Added (new line 32):     Pagination get() throws BadRequestException;

File: rest/src/main/java/org/envirocar/server/rest/validation/JSONSchemaResourceFilterFactory.java ======================
    - Additions: 3
    - Deletions: 11
=======================================================

    ---Removed (old line 314):             GZIPInputStream gzin = null;
    ---Removed (old line 315):             ByteArrayInputStream bain = null;
    ---Removed (old line 316):             ByteArrayOutputStream out = null;
    ---Removed (old line 317):             try {
    ---Removed (old line 318):                 bain = new ByteArrayInputStream(bytes);
    ---Removed (old line 319):                 out = new ByteArrayOutputStream();
    ---Removed (old line 320):                 gzin = new GZIPInputStream(bain);
    +++Added (new line 314):             try (ByteArrayInputStream bain = new ByteArrayInputStream(bytes);
    +++Added (new line 315):                  ByteArrayOutputStream out = new ByteArrayOutputStream();
    +++Added (new line 316):                  GZIPInputStream gzin = new GZIPInputStream(bain)) {
    ---Removed (old line 328):             } finally {
    ---Removed (old line 329):                 Closeables.closeQuietly(bain);
    ---Removed (old line 330):                 Closeables.closeQuietly(gzin);
    ---Removed (old line 331):                 Closeables.closeQuietly(out);

File: webapp/src/main/java/org/envirocar/server/ServletContextListener.java ======================
    - Additions: 3
    - Deletions: 5
=======================================================

    ---Removed (old line 19): import java.util.logging.Handler;
    +++Added (new line 19): import java.util.Arrays;
    ---Removed (old line 50):         Handler[] handlers = rootLogger.getHandlers();
    ---Removed (old line 51):         for (int i = 0; i < handlers.length; i++) {
    ---Removed (old line 52):             rootLogger.removeHandler(handlers[i]);
    ---Removed (old line 53):         }
    +++Added (new line 50):         Arrays.stream(rootLogger.getHandlers())
    +++Added (new line 51):                 .forEach(rootLogger::removeHandler);

